---
import FrontPage from "@/layouts/FrontPage.astro";

import Icon from "@/components/index/Icon.astro";

import Club from "@/components/index/Club.astro";
import { type carrouselT } from "@/components/index/Carrousel/Carrousel";

import Tetris from "@/assets/tetris.svg";
import Trophy from "@/assets/trophy.svg";
import Proj from "@/assets/proj.svg";
import Pen_Ruler from "@/assets/pen_ruler.svg";
import Mic from "@/assets/mic.svg";
import Dices from "@/assets/dices.svg";

import PLSociety from "@/assets/logos/pls.png";
import LuxLudi from "@/assets/logos/luxludi.png";
import LeDLC from "@/assets/logos/dlc.png";

import { Content as Festival } from "@/content/accueil/festival.md";
import { Content as Association } from "@/content/accueil/association.md";

const navBar = [
  { name: "le festival", link: "#festival" },
  { name: "association", link: "#association" },
  { name: "clubs", link: "#clubs" },
  { name: "programme", link: "#programme" },
];

const posts = await Astro.glob<{ title: string; image: string }>(
  "../content/accueil/programme/*.md"
);

// import all the carrousel images
const carrousel = (
  await Astro.glob<carrouselT & { priority: boolean; inCarrousel: boolean }>(
    "../content/carrousel/**/*.md"
  )
)
  .filter((e) => e.frontmatter.inCarrousel)
  .map((e) => {
    return {
      title: e.frontmatter.title,
      subtitle: e.frontmatter.subtitle,
      src: e.frontmatter.src,
      alt: e.frontmatter.alt ?? "",
      priority: e.frontmatter.priority ?? false,
    };
  }) as (carrouselT & { priority: boolean })[];

const priorityCarrousel = carrousel.filter((e) => e.priority);

// importing the carrousel images for PSU
const psuCar = (
  await Astro.glob<carrouselT>("../content/carrousel/PSU/*.md")
).map((e) => {
  return {
    title: e.frontmatter.title,
    subtitle: e.frontmatter.subtitle,
    src: e.frontmatter.src,
    alt: e.frontmatter.alt ?? "",
  };
}) as carrouselT[];

// On met les images prioritaire et psu en premier, mais ils sont en double, removing duplicates
const slides = [...priorityCarrousel, ...psuCar, ...carrousel].reduce(
  (acc, curr) => {
    if (acc.find((e) => e.src === curr.src)) return acc;
    return [...acc, curr];
  },
  [] as carrouselT[]
);
---

<FrontPage
  title="Play Sorbonne Université"
  prefetchs={[carrousel[0].src]}
  slides={slides}
  nav={navBar}
>
  <section class="festival" id="festival">
    <div class="content">
      <h1 class="title title__festival">Le festival</h1>
      <div class="color_ligne"></div>
      <Festival />

      <div class="icons">
        <Icon
          img={Tetris.src}
          title="Rétro-gaming"
          subtitle="pour les nostalgiques"
        />
        <Icon
          img={Pen_Ruler.src}
          title="Jeux indés"
          subtitle="pour les pionners"
        />
        <Icon
          img={Trophy.src}
          title="E-sport"
          subtitle="pour les try-hardeurs"
        />
        <Icon
          img={Mic.src}
          title="Conférences"
          subtitle="pour les intellectuels"
        />
        <Icon img={Dices.src} title="Jeux de plateau" subtitle="pour les IRL" />
        <Icon img={Proj.src} title="Expos" subtitle="pour les curieux" />
      </div>
    </div>
  </section>

  <section class="association" id="association">
    <div class="content">
      <h1 class="title title__association">L'association</h1>
      <div class="color_ligne"></div>
      <Association />
    </div>
  </section>

  <section class="clubs" id="clubs">
    <div class="content">
      <h1 class="title">Les Clubs</h1>
      <div class="color_ligne"></div>

      <p>
        <strong
          >L'association Play Sorbonne Université (PSU) a pour projet d'étendre
          ses actions pour partager la passion du jeu au plus grand nombre au
          sein de l'université. Pour mieux nous organiser dans cette entreprise,
          nous avons choisi de diviser nos principaux objectifs en plusieurs
          équipes : Lux Ludi, le DLC, Loading Games et Play & Learn Society.</strong
        >
      </p>

      <div class="icons__clubs">
        <Club img={PLSociety.src}>
          <p>
            Vulgariser, dévoiler, transmettre. Nous avons pour but de donner de
            la légitimité au domaine du jeu vidéo, en traitant avec rigueur les
            thèmes associés, dont la recherche axée sur ce domaine.
          </p>
        </Club>
        <Club img={LeDLC.src}>
          <p>
            Le club le DLC a pour objectif d'animer la vie du campus, de
            fidéliser les étudiants et de créer des liens avec d'autres
            associations.
          </p>
        </Club>
        <Club img={LuxLudi.src}>
          <p>
            Le club Lux Ludi a pour but de trouver, produire et diffuser des
            jeux de société inventés par les étudiants de Sorbonne Université.
          </p>
        </Club>
      </div>
    </div>
  </section>

  <section class="programme" id="programme">
    <div class="content">
      <h1 class="title">Le programme</h1>
      <div class="color_ligne"></div>

      <div class="content__programme">
        {
          posts.map((post, i) => (
            <div class="element">
              <p class="title__element">{post.frontmatter.title}</p>
              <div class={`content__element ${i % 2 && "content_left"}`}>
                <img
                  loading="lazy"
                  src={post.frontmatter.image}
                  alt=""
                  class="img__element"
                />
                <div>
                  <post.Content />
                </div>
              </div>
            </div>
          ))
        }
      </div>
    </div>
  </section>
</FrontPage>

<style>
  .content {
    max-width: 900px;
    width: 100%;
  }

  .text__titre {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    color: white;
  }

  .title {
    font-size: 3rem;
    font-weight: 900;
    text-transform: uppercase;
  }

  .subtitle__titre {
    font-size: 2rem;
    font-weight: 200;
    text-transform: uppercase;
  }

  @media (max-width: 768px) {
    .title {
      font-size: 2rem;
    }

    .subtitle__titre {
      font-size: 1.3rem;
    }
  }

  .title__festival {
    color: rgb(var(--black-title));
  }

  strong {
    font-weight: 500;
  }

  p {
    padding-top: 20px;
  }

  .icons {
    width: 100%;
    display: flex;
    justify-content: space-around;
    align-items: center;
    flex-wrap: wrap;
  }

  .association {
    background-color: rgb(var(--dark-color));
    color: white;
  }

  .title__association {
    color: white;
  }

  .icons__clubs {
    display: flex;
    flex-direction: row;
    justify-content: center;
    align-items: flex-start;
    flex-wrap: wrap;
    padding: 20px 0;
    width: 100%;
  }

  @media (max-width: 768px) {
    .icons__clubs {
      flex-direction: column;
      align-items: center;
      padding: 0;
    }
  }

  .content__programme {
    padding-top: 20px;
  }

  .img__element {
    max-width: 40%;
    max-height: 200px;
    height: 100%;
    box-shadow: 8px 8px 2px 1px rgba(var(--main-color), 0.4);
    margin: 0 20px;
  }

  .content__element {
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    align-items: center;
  }

  .content_left {
    flex-direction: row-reverse;
  }

  @media (max-width: 768px) {
    .content__element {
      flex-direction: column;
      align-items: center;
    }

    .content_left {
      flex-direction: column;
    }
  }

  .title__element {
    font-weight: bold;
    text-decoration: underline;
  }

  .element {
    padding: 5px 0;
  }
</style>
